<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pixel Tanks Battle</title>
  <link href="/static/favicon.ico" rel="icon" type="image/png">
  <link rel="stylesheet" href="/static/style.css">
  <script src="/socket.io/socket.io.js"></script>
</head>

<body>
  <!-- Приветственное меню -->
  <div id="menu-overlay">
    <div class="menu-container">
      <div class="menu-title">TANK BATTLE</div>
      <div class="menu-subtitle">Pixel War Arena</div>
      <div class="input-group">
        <label for="player-name">Enter Your Callsign:</label>
        <input type="text" id="player-name" maxlength="15" placeholder="Warrior" autocomplete="off">
      </div>
      <div class="color-selection">
        <label>Choose Your Tank Color:</label>
        <div class="color-palette">
          <div class="color-option" data-color="#ffffff" style="background-color: #ffffff;" title="White"></div>
          <div class="color-option" data-color="#04847c" style="background-color: #04847c;" title="Teal"></div>
          <div class="color-option" data-color="#c20000" style="background-color: #c20000;" title="Red"></div>
          <div class="color-option" data-color="#007f9b" style="background-color: #007f9b;" title="Blue"></div>
          <div class="color-option" data-color="#ab8f00" style="background-color: #ab8f00;" title="Yellow"></div>
          <div class="color-option" data-color="#006b44" style="background-color: #006b44;" title="Mint"></div>
          <div class="color-option" data-color="#FF8B94" style="background-color: #FF8B94;" title="Pink"></div>
          <div class="color-option" data-color="#3100ab" style="background-color: #3100ab;" title="Purple"></div>
        </div>
      </div>
      <button class="btn-start" id="btn-start">START BATTLE</button>
    </div>
  </div>

  <!-- Игровой контейнер -->
  <div class="wrapper">
    <div id="root"></div>
  </div>

  <script>
    // Инициализация меню
    document.addEventListener('DOMContentLoaded', function () {
      const menuOverlay = document.getElementById('menu-overlay');
      const playerNameInput = document.getElementById('player-name');
      const btnStart = document.getElementById('btn-start');
      const colorOptions = document.querySelectorAll('.color-option');

      // Загружаем сохраненные данные
      const savedName = localStorage.getItem('playerName') || '';
      const savedColor = localStorage.getItem('playerColor') || '#00AA00';
      playerNameInput.value = savedName;
      playerNameInput.focus();

      // Устанавливаем сохраненный цвет
      colorOptions.forEach(option => {
        if (option.dataset.color === savedColor) {
          option.classList.add('selected');
        }
      });

      // Обработка выбора цвета
      colorOptions.forEach(option => {
        option.addEventListener('click', function () {
          // Убираем выделение с других цветов
          colorOptions.forEach(opt => opt.classList.remove('selected'));
          // Выделяем выбранный цвет
          this.classList.add('selected');
        });
      });

      // Обработка старта игры
      function startGame() {
        const name = playerNameInput.value.trim();
        const selectedColor = document.querySelector('.color-option.selected').dataset.color;

        if (!name) {
          playerNameInput.focus();
          playerNameInput.style.borderColor = '#ff4444';
          setTimeout(() => {
            playerNameInput.style.borderColor = '';
          }, 500);
          return;
        }

        // Сохраняем данные
        localStorage.setItem('playerName', name);
        localStorage.setItem('playerColor', selectedColor);

        // Скрываем меню
        menuOverlay.classList.add('hidden');

        // Передаем данные в игровой код через глобальные переменные
        window.playerName = name;
        window.playerColor = selectedColor;
        window.gameStarted = true;
      }

      btnStart.addEventListener('click', startGame);
      playerNameInput.addEventListener('keypress', function (e) {
        if (e.key === 'Enter') {
          startGame();
        }
      });
    });
  </script>
</body>
<script src="/static/index.js" type="module"></script>

</html>